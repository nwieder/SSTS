<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Exact Stochastic Simulation Software: nw::Diffusion_Evt Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Exact Stochastic Simulation Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dd/d54/namespacenw.html">nw</a></li><li class="navelem"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html">Diffusion_Evt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d2/da0/classnw_1_1_diffusion___evt-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nw::Diffusion_Evt Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Realization of diffusion between two voxels.  
 <a href="../../db/d40/classnw_1_1_diffusion___evt.html#details">More...</a></p>

<p><code>#include &lt;Diffusion_Evt.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for nw::Diffusion_Evt:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../db/d40/classnw_1_1_diffusion___evt.png" usemap="#nw::Diffusion_Evt_map" alt=""/>
  <map id="nw::Diffusion_Evt_map" name="nw::Diffusion_Evt_map">
<area href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). " alt="nw::_Event" shape="rect" coords="0,0,109,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa7a2892e0b8c19e58df2a37ab71213cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#aa7a2892e0b8c19e58df2a37ab71213cc">Diffusion_Evt</a> (long <a class="el" href="../../d8/d98/classnw_1_1___event.html#a8f7ce287f596266dd763ec7db2f74090">id</a>, string <a class="el" href="../../d8/d98/classnw_1_1___event.html#ab4f50a54039cd4957bdca55049178562">name</a>, double <a class="el" href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">k</a>, <a class="el" href="../../dd/d54/namespacenw.html#ad7146b8b5a9de9be416847f41135722c">VoxelVector</a> vvc, long diff_spc_id, <a class="el" href="../../d3/dc1/classnw_1_1_uni___rnd.html">Uni_Rnd</a> *<a class="el" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a>)</td></tr>
<tr class="memdesc:aa7a2892e0b8c19e58df2a37ab71213cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of Diffusion Event.  <a href="#aa7a2892e0b8c19e58df2a37ab71213cc">More...</a><br /></td></tr>
<tr class="separator:aa7a2892e0b8c19e58df2a37ab71213cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13608fc5a0cbe6e77caeca4cd77def61"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a13608fc5a0cbe6e77caeca4cd77def61">~Diffusion_Evt</a> ()</td></tr>
<tr class="separator:a13608fc5a0cbe6e77caeca4cd77def61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35841daf14d9ba472c0ed1f414187097"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a35841daf14d9ba472c0ed1f414187097">update</a> (double)</td></tr>
<tr class="memdesc:a35841daf14d9ba472c0ed1f414187097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#a882115f8652c881bc8ed43f1050ccba3" title="Updates the event. ">_Event::update()</a> method.  <a href="#a35841daf14d9ba472c0ed1f414187097">More...</a><br /></td></tr>
<tr class="separator:a35841daf14d9ba472c0ed1f414187097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd6413241bd01ecb6a58fc0359ab57b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a5cd6413241bd01ecb6a58fc0359ab57b">execute</a> ()</td></tr>
<tr class="memdesc:a5cd6413241bd01ecb6a58fc0359ab57b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#aa022418fb765582a053ac75cbc3436d6" title="Event execution function. ">_Event::execute()</a> method.  <a href="#a5cd6413241bd01ecb6a58fc0359ab57b">More...</a><br /></td></tr>
<tr class="separator:a5cd6413241bd01ecb6a58fc0359ab57b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaaca9b5b7e6902189dfc79d8d5a4f99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#adaaca9b5b7e6902189dfc79d8d5a4f99">init</a> ()</td></tr>
<tr class="memdesc:adaaca9b5b7e6902189dfc79d8d5a4f99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#ae2c608ee2508058d6f318ca2ca8f4317" title="Event initialization. ">_Event::init()</a> method initializes a diffusion. State change vector is generated and the event propensity is calculated.  <a href="#adaaca9b5b7e6902189dfc79d8d5a4f99">More...</a><br /></td></tr>
<tr class="separator:adaaca9b5b7e6902189dfc79d8d5a4f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468711cd0c37b2129898cb8e79c2f085"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a468711cd0c37b2129898cb8e79c2f085">get_a</a> ()</td></tr>
<tr class="memdesc:a468711cd0c37b2129898cb8e79c2f085"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#a75945699f539cefab36eb6693a389918" title="returns current _Event propensity a. ">_Event::get_a()</a> method.  <a href="#a468711cd0c37b2129898cb8e79c2f085">More...</a><br /></td></tr>
<tr class="separator:a468711cd0c37b2129898cb8e79c2f085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classnw_1_1___event"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classnw_1_1___event')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d8/d98/classnw_1_1___event.html">nw::_Event</a></td></tr>
<tr class="memitem:a5efb757db20b083de6da605ea4b2bbae inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a5efb757db20b083de6da605ea4b2bbae">_Event</a> (long <a class="el" href="../../d8/d98/classnw_1_1___event.html#a8f7ce287f596266dd763ec7db2f74090">id</a>, string <a class="el" href="../../d8/d98/classnw_1_1___event.html#ab4f50a54039cd4957bdca55049178562">name</a>, double <a class="el" href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">k</a>, <a class="el" href="../../dd/d54/namespacenw.html#ad7146b8b5a9de9be416847f41135722c">VoxelVector</a> vvc, <a class="el" href="../../d3/dc1/classnw_1_1_uni___rnd.html">Uni_Rnd</a> *<a class="el" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a>)</td></tr>
<tr class="memdesc:a5efb757db20b083de6da605ea4b2bbae inherit pub_methods_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a5efb757db20b083de6da605ea4b2bbae">More...</a><br /></td></tr>
<tr class="separator:a5efb757db20b083de6da605ea4b2bbae inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede7a9b059e398c72320ad6d27ad6b2d inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#aede7a9b059e398c72320ad6d27ad6b2d">~_Event</a> ()</td></tr>
<tr class="memdesc:aede7a9b059e398c72320ad6d27ad6b2d inherit pub_methods_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#aede7a9b059e398c72320ad6d27ad6b2d">More...</a><br /></td></tr>
<tr class="separator:aede7a9b059e398c72320ad6d27ad6b2d inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae58637d427d9fa023850a1f8342912 inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#afae58637d427d9fa023850a1f8342912">add_dep_list</a> (<a class="el" href="../../d8/d98/classnw_1_1___event.html">_Event</a> *e)</td></tr>
<tr class="memdesc:afae58637d427d9fa023850a1f8342912 inherit pub_methods_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an <a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> pointer to the dependency list.  <a href="#afae58637d427d9fa023850a1f8342912">More...</a><br /></td></tr>
<tr class="separator:afae58637d427d9fa023850a1f8342912 inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f533e8b22bece51864a24d1f4d8534 inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a05f533e8b22bece51864a24d1f4d8534">set_flag</a> (bool b)</td></tr>
<tr class="memdesc:a05f533e8b22bece51864a24d1f4d8534 inherit pub_methods_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the dirty flag.  <a href="#a05f533e8b22bece51864a24d1f4d8534">More...</a><br /></td></tr>
<tr class="separator:a05f533e8b22bece51864a24d1f4d8534 inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a982b9a043c4bcdd562b29cbba428760f inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a982b9a043c4bcdd562b29cbba428760f">get_name</a> ()</td></tr>
<tr class="separator:a982b9a043c4bcdd562b29cbba428760f inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc5fa1db0c336b4d464f94274a015cf4 inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#abc5fa1db0c336b4d464f94274a015cf4">get_id</a> ()</td></tr>
<tr class="separator:abc5fa1db0c336b4d464f94274a015cf4 inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58559a4aa257c900e3ff2e09bc0410b inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#ae58559a4aa257c900e3ff2e09bc0410b">get_tau</a> ()</td></tr>
<tr class="separator:ae58559a4aa257c900e3ff2e09bc0410b inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b32388aa5263ab4ccd16c964c7a4a9b inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a9b32388aa5263ab4ccd16c964c7a4a9b">get_sc_vec</a> ()</td></tr>
<tr class="separator:a9b32388aa5263ab4ccd16c964c7a4a9b inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d2e7f276e03337196eee24c0d43efc inherit pub_methods_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="../../d8/d98/classnw_1_1___event.html">_Event</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a63d2e7f276e03337196eee24c0d43efc">get_dep_list</a> ()</td></tr>
<tr class="separator:a63d2e7f276e03337196eee24c0d43efc inherit pub_methods_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a45b4ac64dd8f202de5b1e590b7a88621"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a45b4ac64dd8f202de5b1e590b7a88621">calc_tau</a> (long)</td></tr>
<tr class="memdesc:a45b4ac64dd8f202de5b1e590b7a88621"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to calculate next tau value of a voxel.  <a href="#a45b4ac64dd8f202de5b1e590b7a88621">More...</a><br /></td></tr>
<tr class="separator:a45b4ac64dd8f202de5b1e590b7a88621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207aa73a53839282e1a399b5d4d7c3d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a207aa73a53839282e1a399b5d4d7c3d1">build_sc_vec</a> ()</td></tr>
<tr class="memdesc:a207aa73a53839282e1a399b5d4d7c3d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">builds the state change vector and the inverse state change vector of the diffusion event.  <a href="#a207aa73a53839282e1a399b5d4d7c3d1">More...</a><br /></td></tr>
<tr class="separator:a207aa73a53839282e1a399b5d4d7c3d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab975d8f0ae97844b4d43222e94871707"><td class="memItemLeft" align="right" valign="top">vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">inv_sc_vec</a></td></tr>
<tr class="memdesc:ab975d8f0ae97844b4d43222e94871707"><td class="mdescLeft">&#160;</td><td class="mdescRight">inverse sc_vec to update origin diffusion voxel (* -1)  <a href="#ab975d8f0ae97844b4d43222e94871707">More...</a><br /></td></tr>
<tr class="separator:ab975d8f0ae97844b4d43222e94871707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7193335899a1d41a902dff91fc0029dd"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a></td></tr>
<tr class="memdesc:a7193335899a1d41a902dff91fc0029dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">id of the species which diffusion is represented by this Event  <a href="#a7193335899a1d41a902dff91fc0029dd">More...</a><br /></td></tr>
<tr class="separator:a7193335899a1d41a902dff91fc0029dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classnw_1_1___event"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classnw_1_1___event')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d8/d98/classnw_1_1___event.html">nw::_Event</a></td></tr>
<tr class="memitem:a8f7ce287f596266dd763ec7db2f74090 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a8f7ce287f596266dd763ec7db2f74090">id</a></td></tr>
<tr class="memdesc:a8f7ce287f596266dd763ec7db2f74090 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">ID.  <a href="#a8f7ce287f596266dd763ec7db2f74090">More...</a><br /></td></tr>
<tr class="separator:a8f7ce287f596266dd763ec7db2f74090 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f50a54039cd4957bdca55049178562 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#ab4f50a54039cd4957bdca55049178562">name</a></td></tr>
<tr class="memdesc:ab4f50a54039cd4957bdca55049178562 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name.  <a href="#ab4f50a54039cd4957bdca55049178562">More...</a><br /></td></tr>
<tr class="separator:ab4f50a54039cd4957bdca55049178562 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca0ae816e9834add07db8e9a6618faa inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">k</a></td></tr>
<tr class="memdesc:afca0ae816e9834add07db8e9a6618faa inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate constant.  <a href="#afca0ae816e9834add07db8e9a6618faa">More...</a><br /></td></tr>
<tr class="separator:afca0ae816e9834add07db8e9a6618faa inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a560c8b6f9954a43f5d5f80204473b64d inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">sc_vec</a></td></tr>
<tr class="memdesc:a560c8b6f9954a43f5d5f80204473b64d inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">State change vector. Defines an event in terms of a vector, representing the molecular change for each existing <a class="el" href="../../d3/d03/classnw_1_1___species.html" title="Abstract base class for the molecular species of a system. ">_Species</a>.  <a href="#a560c8b6f9954a43f5d5f80204473b64d">More...</a><br /></td></tr>
<tr class="separator:a560c8b6f9954a43f5d5f80204473b64d inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6351b58d94923ed58e0b2cf6c9445d2e inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="../../d7/dfa/structnw_1_1___event_1_1tv__struct.html">tv_struct</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a></td></tr>
<tr class="memdesc:a6351b58d94923ed58e0b2cf6c9445d2e inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tau voxel vector. Container for tv_structs, each representing a <a class="el" href="../../d3/d7a/classnw_1_1___voxel.html" title="Abstract base class for voxel (discrete building blocks of the simulation volume) ...">_Voxel</a> where this <a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> can occur.  <a href="#a6351b58d94923ed58e0b2cf6c9445d2e">More...</a><br /></td></tr>
<tr class="separator:a6351b58d94923ed58e0b2cf6c9445d2e inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92482aeea55562560573ecccd5ab108 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/dc1/classnw_1_1_uni___rnd.html">Uni_Rnd</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a></td></tr>
<tr class="memdesc:af92482aeea55562560573ecccd5ab108 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uniform random number generator.  <a href="#af92482aeea55562560573ecccd5ab108">More...</a><br /></td></tr>
<tr class="separator:af92482aeea55562560573ecccd5ab108 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7864559e204c087306e3becb5b81fb26 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a></td></tr>
<tr class="memdesc:a7864559e204c087306e3becb5b81fb26 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of next <a class="el" href="../../d3/d7a/classnw_1_1___voxel.html" title="Abstract base class for voxel (discrete building blocks of the simulation volume) ...">_Voxel</a> to be executed.  <a href="#a7864559e204c087306e3becb5b81fb26">More...</a><br /></td></tr>
<tr class="separator:a7864559e204c087306e3becb5b81fb26 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c77fb164e745cdb5c5fda4f191cd37 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">c</a></td></tr>
<tr class="memdesc:a29c77fb164e745cdb5c5fda4f191cd37 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adapted <a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> rate constant. Based on the type of <a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> <code>c</code> is depends on <a class="el" href="../../d3/d7a/classnw_1_1___voxel.html" title="Abstract base class for voxel (discrete building blocks of the simulation volume) ...">_Voxel</a> volume (bimoleuclar reactions) or <a class="el" href="../../d3/d7a/classnw_1_1___voxel.html" title="Abstract base class for voxel (discrete building blocks of the simulation volume) ...">_Voxel</a> box length (diffusion)  <a href="#a29c77fb164e745cdb5c5fda4f191cd37">More...</a><br /></td></tr>
<tr class="separator:a29c77fb164e745cdb5c5fda4f191cd37 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa705b35c06c0cb2e0a4f3daa9ee8037 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#aaa705b35c06c0cb2e0a4f3daa9ee8037">dirty_flag</a></td></tr>
<tr class="memdesc:aaa705b35c06c0cb2e0a4f3daa9ee8037 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">indicates wheather or not the tau value has to be recalculated (<code>TRUE</code>) or adapted to the absolute time scale (<code>FALSE</code>)  <a href="#aaa705b35c06c0cb2e0a4f3daa9ee8037">More...</a><br /></td></tr>
<tr class="separator:aaa705b35c06c0cb2e0a4f3daa9ee8037 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f87b2dff69d07977f0a5e10936f38f6 inherit pro_attribs_classnw_1_1___event"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="../../d8/d98/classnw_1_1___event.html">_Event</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d98/classnw_1_1___event.html#a3f87b2dff69d07977f0a5e10936f38f6">dep_list</a></td></tr>
<tr class="memdesc:a3f87b2dff69d07977f0a5e10936f38f6 inherit pro_attribs_classnw_1_1___event"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dependency vector that stores references to _Events that depend on this <a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a>.  <a href="#a3f87b2dff69d07977f0a5e10936f38f6">More...</a><br /></td></tr>
<tr class="separator:a3f87b2dff69d07977f0a5e10936f38f6 inherit pro_attribs_classnw_1_1___event"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Realization of diffusion between two voxels. </p>
<p>The Diffusion_Event alters the stae vector of two adjacent Voxel. The <a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html#a5cd6413241bd01ecb6a58fc0359ab57b" title="Diffusion implementation of _Event::execute() method. ">execute()</a> function thus needs a second random number to determine the diffusion partner from the voxel diff list. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa7a2892e0b8c19e58df2a37ab71213cc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">nw::Diffusion_Evt::Diffusion_Evt </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d54/namespacenw.html#ad7146b8b5a9de9be416847f41135722c">VoxelVector</a>&#160;</td>
          <td class="paramname"><em>vvc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>diff_spc_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dc1/classnw_1_1_uni___rnd.html">Uni_Rnd</a> *&#160;</td>
          <td class="paramname"><em>rg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor of Diffusion Event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td><a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> ID </td></tr>
    <tr><td class="paramname">name</td><td><a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> name </td></tr>
    <tr><td class="paramname">k</td><td><a class="el" href="../../d8/d98/classnw_1_1___event.html" title="Abstract base class for system state transitions (events). ">_Event</a> rate constant </td></tr>
    <tr><td class="paramname">vvc</td><td>vector of all voxel where this event can occur </td></tr>
    <tr><td class="paramname">diff_spc_id</td><td>indicates the id of the diffusing molecule species </td></tr>
    <tr><td class="paramname">rg</td><td>Pointer to the Random_Generator </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                                                                                :</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="../../d8/d98/classnw_1_1___event.html#a5efb757db20b083de6da605ea4b2bbae">_Event</a>(<span class="keywordtype">id</span>,<a class="code" href="../../d8/d98/classnw_1_1___event.html#ab4f50a54039cd4957bdca55049178562">name</a>,<a class="code" href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">k</a>,vvc,<a class="code" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a>){</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        this-&gt;<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a> = diff_spc_id;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a207aa73a53839282e1a399b5d4d7c3d1">build_sc_vec</a>();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="ttc" id="classnw_1_1___event_html_af92482aeea55562560573ecccd5ab108"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">nw::_Event::rg</a></div><div class="ttdeci">Uni_Rnd * rg</div><div class="ttdoc">Uniform random number generator. </div><div class="ttdef"><b>Definition:</b> _Event.h:129</div></div>
<div class="ttc" id="classnw_1_1___event_html_ab4f50a54039cd4957bdca55049178562"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#ab4f50a54039cd4957bdca55049178562">nw::_Event::name</a></div><div class="ttdeci">string name</div><div class="ttdoc">Name. </div><div class="ttdef"><b>Definition:</b> _Event.h:125</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a7193335899a1d41a902dff91fc0029dd"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">nw::Diffusion_Evt::diff_spec_id</a></div><div class="ttdeci">long diff_spec_id</div><div class="ttdoc">id of the species which diffusion is represented by this Event </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:51</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a207aa73a53839282e1a399b5d4d7c3d1"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a207aa73a53839282e1a399b5d4d7c3d1">nw::Diffusion_Evt::build_sc_vec</a></div><div class="ttdeci">void build_sc_vec()</div><div class="ttdoc">builds the state change vector and the inverse state change vector of the diffusion event...</div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.cpp:85</div></div>
<div class="ttc" id="classnw_1_1___event_html_a5efb757db20b083de6da605ea4b2bbae"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a5efb757db20b083de6da605ea4b2bbae">nw::_Event::_Event</a></div><div class="ttdeci">_Event(long id, string name, double k, VoxelVector vvc, Uni_Rnd *rg)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> _Event.h:35</div></div>
<div class="ttc" id="classnw_1_1___event_html_afca0ae816e9834add07db8e9a6618faa"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">nw::_Event::k</a></div><div class="ttdeci">double k</div><div class="ttdoc">Rate constant. </div><div class="ttdef"><b>Definition:</b> _Event.h:126</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13608fc5a0cbe6e77caeca4cd77def61"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual nw::Diffusion_Evt::~Diffusion_Evt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor </p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a207aa73a53839282e1a399b5d4d7c3d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nw::Diffusion_Evt::build_sc_vec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>builds the state change vector and the inverse state change vector of the diffusion event. </p>
<p>Helper function to build an inverse sc_vector. Number of molecules in the origin Voxel has to be decreased, while number of molecules in the target voxel has to be increased. Thus <a class="el" href="../../db/d40/classnw_1_1_diffusion___evt.html" title="Realization of diffusion between two voxels. ">Diffusion_Evt</a> requires two state change vectors.builds a state change vector using diff_spec_id </p>
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//  build sc_vec</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">sc_vec</a>.assign(<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[0].v-&gt;get_state_vec()-&gt;size(),0);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">inv_sc_vec</a>.assign(<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[0].v-&gt;get_state_vec()-&gt;size(),0);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">sc_vec</a>[<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a>] = -1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">inv_sc_vec</a>[<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a>] = 1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_ab975d8f0ae97844b4d43222e94871707"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">nw::Diffusion_Evt::inv_sc_vec</a></div><div class="ttdeci">vector&lt; long &gt; inv_sc_vec</div><div class="ttdoc">inverse sc_vec to update origin diffusion voxel (* -1) </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:50</div></div>
<div class="ttc" id="classnw_1_1___event_html_a560c8b6f9954a43f5d5f80204473b64d"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">nw::_Event::sc_vec</a></div><div class="ttdeci">vector&lt; long &gt; sc_vec</div><div class="ttdoc">State change vector. Defines an event in terms of a vector, representing the molecular change for eac...</div><div class="ttdef"><b>Definition:</b> _Event.h:127</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a7193335899a1d41a902dff91fc0029dd"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">nw::Diffusion_Evt::diff_spec_id</a></div><div class="ttdeci">long diff_spec_id</div><div class="ttdoc">id of the species which diffusion is represented by this Event </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:51</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a45b4ac64dd8f202de5b1e590b7a88621"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nw::Diffusion_Evt::calc_tau </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>vid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>function to calculate next tau value of a voxel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vid</td><td>the Voxel id of the voxel which has to be updated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new tau value </dd></dl>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                      {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//  adapt the c value to the number of diffusion sites!</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">double</span> c_adapted =  <a class="code" href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">c</a> * <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>.at(vid).v-&gt;get_diff_vec()-&gt;size();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//  calculate tau</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[vid].t = -log(<a class="code" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a>-&gt;<a class="code" href="../../d3/dc1/classnw_1_1_uni___rnd.html#ad7883ef0ce4c591612bcb41678104773">get_Uni_Rnd</a>()) / (<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[vid].v-&gt;get_state_vec()-&gt;at(<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a>)-&gt;get_n_molecules() * c_adapted);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[vid].t;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="ttc" id="classnw_1_1___event_html_af92482aeea55562560573ecccd5ab108"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">nw::_Event::rg</a></div><div class="ttdeci">Uni_Rnd * rg</div><div class="ttdoc">Uniform random number generator. </div><div class="ttdef"><b>Definition:</b> _Event.h:129</div></div>
<div class="ttc" id="classnw_1_1_uni___rnd_html_ad7883ef0ce4c591612bcb41678104773"><div class="ttname"><a href="../../d3/dc1/classnw_1_1_uni___rnd.html#ad7883ef0ce4c591612bcb41678104773">nw::Uni_Rnd::get_Uni_Rnd</a></div><div class="ttdeci">double get_Uni_Rnd()</div><div class="ttdoc">Implementation of the _Random::get_Uni_Rnd() method. </div><div class="ttdef"><b>Definition:</b> Uni_Rnd.cpp:63</div></div>
<div class="ttc" id="classnw_1_1___event_html_a29c77fb164e745cdb5c5fda4f191cd37"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">nw::_Event::c</a></div><div class="ttdeci">double c</div><div class="ttdoc">Adapted _Event rate constant. Based on the type of _Event c is depends on _Voxel volume (bimoleuclar ...</div><div class="ttdef"><b>Definition:</b> _Event.h:132</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a7193335899a1d41a902dff91fc0029dd"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">nw::Diffusion_Evt::diff_spec_id</a></div><div class="ttdeci">long diff_spec_id</div><div class="ttdoc">id of the species which diffusion is represented by this Event </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:51</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5cd6413241bd01ecb6a58fc0359ab57b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nw::Diffusion_Evt::execute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#aa022418fb765582a053ac75cbc3436d6" title="Event execution function. ">_Event::execute()</a> method. </p>
<p>Two voxels have to be updated. Decrease the number of molecules by one inside the origin voxel and increase the number of molecules by one in the target voxel. The target voxel is determined randomly from the diffusion vector that defines the vicinity relation of different voxel. </p>

<p>Implements <a class="el" href="../../d8/d98/classnw_1_1___event.html#aa022418fb765582a053ac75cbc3436d6">nw::_Event</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                           {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//  update diffusion origin voxel with the inverse state change vector</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[<a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a>].v-&gt;update_state(<a class="code" href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">sc_vec</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//  choose diffusion partner</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">double</span> r = <a class="code" href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">rg</a>-&gt;<a class="code" href="../../d3/dc1/classnw_1_1_uni___rnd.html#ad7883ef0ce4c591612bcb41678104773">get_Uni_Rnd</a>();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">double</span> d; <span class="comment">// temp</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[<a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a>].v-&gt;get_diff_vec()-&gt;size(); ++i){</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        d = (double)(i+1)/<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[<a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a>].v-&gt;get_diff_vec()-&gt;size();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">if</span>(r-d &lt; 0){</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[<a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a>].v-&gt;get_diff_vec()-&gt;at(i)-&gt;update_state(<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">inv_sc_vec</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//  set dirty flag to indicate that dependent events have to be updated properly</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/d98/classnw_1_1___event.html#a3f87b2dff69d07977f0a5e10936f38f6">dep_list</a>.size(); i++){</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="../../d8/d98/classnw_1_1___event.html#a3f87b2dff69d07977f0a5e10936f38f6">dep_list</a>[i]-&gt;set_flag(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="classnw_1_1___event_html_af92482aeea55562560573ecccd5ab108"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#af92482aeea55562560573ecccd5ab108">nw::_Event::rg</a></div><div class="ttdeci">Uni_Rnd * rg</div><div class="ttdoc">Uniform random number generator. </div><div class="ttdef"><b>Definition:</b> _Event.h:129</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_ab975d8f0ae97844b4d43222e94871707"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#ab975d8f0ae97844b4d43222e94871707">nw::Diffusion_Evt::inv_sc_vec</a></div><div class="ttdeci">vector&lt; long &gt; inv_sc_vec</div><div class="ttdoc">inverse sc_vec to update origin diffusion voxel (* -1) </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:50</div></div>
<div class="ttc" id="classnw_1_1_uni___rnd_html_ad7883ef0ce4c591612bcb41678104773"><div class="ttname"><a href="../../d3/dc1/classnw_1_1_uni___rnd.html#ad7883ef0ce4c591612bcb41678104773">nw::Uni_Rnd::get_Uni_Rnd</a></div><div class="ttdeci">double get_Uni_Rnd()</div><div class="ttdoc">Implementation of the _Random::get_Uni_Rnd() method. </div><div class="ttdef"><b>Definition:</b> Uni_Rnd.cpp:63</div></div>
<div class="ttc" id="classnw_1_1___event_html_a560c8b6f9954a43f5d5f80204473b64d"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a560c8b6f9954a43f5d5f80204473b64d">nw::_Event::sc_vec</a></div><div class="ttdeci">vector&lt; long &gt; sc_vec</div><div class="ttdoc">State change vector. Defines an event in terms of a vector, representing the molecular change for eac...</div><div class="ttdef"><b>Definition:</b> _Event.h:127</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
<div class="ttc" id="classnw_1_1___event_html_a3f87b2dff69d07977f0a5e10936f38f6"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a3f87b2dff69d07977f0a5e10936f38f6">nw::_Event::dep_list</a></div><div class="ttdeci">vector&lt; _Event * &gt; dep_list</div><div class="ttdoc">Dependency vector that stores references to _Events that depend on this _Event. </div><div class="ttdef"><b>Definition:</b> _Event.h:134</div></div>
<div class="ttc" id="classnw_1_1___event_html_a7864559e204c087306e3becb5b81fb26"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nw::_Event::nextVoxel</a></div><div class="ttdeci">long nextVoxel</div><div class="ttdoc">Index of next _Voxel to be executed. </div><div class="ttdef"><b>Definition:</b> _Event.h:130</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a468711cd0c37b2129898cb8e79c2f085"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nw::Diffusion_Evt::get_a </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#a75945699f539cefab36eb6693a389918" title="returns current _Event propensity a. ">_Event::get_a()</a> method. </p>

<p>Implements <a class="el" href="../../d8/d98/classnw_1_1___event.html#a75945699f539cefab36eb6693a389918">nw::_Event</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                           {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">double</span> a_ges = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">long</span> i = 0; i &lt; (long) <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>.size(); i++){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        a_ges += <a class="code" href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">c</a>*<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].v-&gt;get_state_vec()-&gt;at(<a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">diff_spec_id</a>)-&gt;get_n_molecules() * <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].v-&gt;get_diff_vec()-&gt;size();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> a_ges;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="classnw_1_1___event_html_a29c77fb164e745cdb5c5fda4f191cd37"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">nw::_Event::c</a></div><div class="ttdeci">double c</div><div class="ttdoc">Adapted _Event rate constant. Based on the type of _Event c is depends on _Voxel volume (bimoleuclar ...</div><div class="ttdef"><b>Definition:</b> _Event.h:132</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a7193335899a1d41a902dff91fc0029dd"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a7193335899a1d41a902dff91fc0029dd">nw::Diffusion_Evt::diff_spec_id</a></div><div class="ttdeci">long diff_spec_id</div><div class="ttdoc">id of the species which diffusion is represented by this Event </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.h:51</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adaaca9b5b7e6902189dfc79d8d5a4f99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nw::Diffusion_Evt::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#ae2c608ee2508058d6f318ca2ca8f4317" title="Event initialization. ">_Event::init()</a> method initializes a diffusion. State change vector is generated and the event propensity is calculated. </p>

<p>Implements <a class="el" href="../../d8/d98/classnw_1_1___event.html#ae2c608ee2508058d6f318ca2ca8f4317">nw::_Event</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                        {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//  calculate the correct diffusion probability constant according to the voxel volume</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    this-&gt;<a class="code" href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">c</a> = (<a class="code" href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">k</a>*1e-3)/pow(<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[0].v-&gt;get_box_length()*1e6,2);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//  build state change vector</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a207aa73a53839282e1a399b5d4d7c3d1">build_sc_vec</a>();</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//  update the first time</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a35841daf14d9ba472c0ed1f414187097">update</a>(0);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;}</div>
<div class="ttc" id="classnw_1_1___event_html_a29c77fb164e745cdb5c5fda4f191cd37"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a29c77fb164e745cdb5c5fda4f191cd37">nw::_Event::c</a></div><div class="ttdeci">double c</div><div class="ttdoc">Adapted _Event rate constant. Based on the type of _Event c is depends on _Voxel volume (bimoleuclar ...</div><div class="ttdef"><b>Definition:</b> _Event.h:132</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a207aa73a53839282e1a399b5d4d7c3d1"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a207aa73a53839282e1a399b5d4d7c3d1">nw::Diffusion_Evt::build_sc_vec</a></div><div class="ttdeci">void build_sc_vec()</div><div class="ttdoc">builds the state change vector and the inverse state change vector of the diffusion event...</div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.cpp:85</div></div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a35841daf14d9ba472c0ed1f414187097"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a35841daf14d9ba472c0ed1f414187097">nw::Diffusion_Evt::update</a></div><div class="ttdeci">double update(double)</div><div class="ttdoc">Diffusion implementation of _Event::update() method. </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.cpp:42</div></div>
<div class="ttc" id="classnw_1_1___event_html_afca0ae816e9834add07db8e9a6618faa"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#afca0ae816e9834add07db8e9a6618faa">nw::_Event::k</a></div><div class="ttdeci">double k</div><div class="ttdoc">Rate constant. </div><div class="ttdef"><b>Definition:</b> _Event.h:126</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a35841daf14d9ba472c0ed1f414187097"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nw::Diffusion_Evt::update </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>last_tau</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Diffusion implementation of <a class="el" href="../../d8/d98/classnw_1_1___event.html#a882115f8652c881bc8ed43f1050ccba3" title="Updates the event. ">_Event::update()</a> method. </p>

<p>Implements <a class="el" href="../../d8/d98/classnw_1_1___event.html#a882115f8652c881bc8ed43f1050ccba3">nw::_Event</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                           {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">double</span> minTau = INFINITY, actTau;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//  check if this event depends on the last executed event</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d8/d98/classnw_1_1___event.html#aaa705b35c06c0cb2e0a4f3daa9ee8037">dirty_flag</a>) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//      run through the tv vector</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>.size(); ++i) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//          check for voxel that have been affected by last executed event</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].v-&gt;get_dirty_flag()) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                actTau = <a class="code" href="../../db/d40/classnw_1_1_diffusion___evt.html#a45b4ac64dd8f202de5b1e590b7a88621">calc_tau</a>(i);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//              find smallest tau value (-&gt;next voxel) for this event</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keywordflow">if</span> (actTau &lt; minTau) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    minTau = actTau;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a> = i;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//          voxel has not been affected by last event</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//              adjust tau value to global times scale</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t -= last_tau;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//              find smallest tau value (-&gt;next voxel) for this event</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t &lt; minTau) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                    minTau = <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    <a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a> = i;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//  event has not been affected by last event</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//      adjust tau values to global times scale</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>.size(); ++i) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t -= last_tau;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t &lt; minTau) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                minTau = <a class="code" href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">tv_vec</a>[i].t;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <a class="code" href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nextVoxel</a> = i;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    this-&gt;<a class="code" href="../../d8/d98/classnw_1_1___event.html#aaa705b35c06c0cb2e0a4f3daa9ee8037">dirty_flag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span> minTau;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="classnw_1_1_diffusion___evt_html_a45b4ac64dd8f202de5b1e590b7a88621"><div class="ttname"><a href="../../db/d40/classnw_1_1_diffusion___evt.html#a45b4ac64dd8f202de5b1e590b7a88621">nw::Diffusion_Evt::calc_tau</a></div><div class="ttdeci">double calc_tau(long)</div><div class="ttdoc">function to calculate next tau value of a voxel. </div><div class="ttdef"><b>Definition:</b> Diffusion_Evt.cpp:94</div></div>
<div class="ttc" id="classnw_1_1___event_html_a6351b58d94923ed58e0b2cf6c9445d2e"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a6351b58d94923ed58e0b2cf6c9445d2e">nw::_Event::tv_vec</a></div><div class="ttdeci">vector&lt; tv_struct &gt; tv_vec</div><div class="ttdoc">Tau voxel vector. Container for tv_structs, each representing a _Voxel where this _Event can occur...</div><div class="ttdef"><b>Definition:</b> _Event.h:128</div></div>
<div class="ttc" id="classnw_1_1___event_html_aaa705b35c06c0cb2e0a4f3daa9ee8037"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#aaa705b35c06c0cb2e0a4f3daa9ee8037">nw::_Event::dirty_flag</a></div><div class="ttdeci">bool dirty_flag</div><div class="ttdoc">indicates wheather or not the tau value has to be recalculated (TRUE) or adapted to the absolute time...</div><div class="ttdef"><b>Definition:</b> _Event.h:133</div></div>
<div class="ttc" id="classnw_1_1___event_html_a7864559e204c087306e3becb5b81fb26"><div class="ttname"><a href="../../d8/d98/classnw_1_1___event.html#a7864559e204c087306e3becb5b81fb26">nw::_Event::nextVoxel</a></div><div class="ttdeci">long nextVoxel</div><div class="ttdoc">Index of next _Voxel to be executed. </div><div class="ttdef"><b>Definition:</b> _Event.h:130</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a7193335899a1d41a902dff91fc0029dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long nw::Diffusion_Evt::diff_spec_id</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>id of the species which diffusion is represented by this Event </p>

</div>
</div>
<a class="anchor" id="ab975d8f0ae97844b4d43222e94871707"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;long&gt; nw::Diffusion_Evt::inv_sc_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>inverse sc_vec to update origin diffusion voxel (* -1) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Events/<a class="el" href="../../d7/d10/_diffusion___evt_8h.html">Diffusion_Evt.h</a></li>
<li>Events/<a class="el" href="../../d4/df2/_diffusion___evt_8cpp.html">Diffusion_Evt.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 1 2014 14:16:04 for Exact Stochastic Simulation Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
